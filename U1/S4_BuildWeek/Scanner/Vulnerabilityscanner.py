import socket

#Inserimento da ,parte dell'utente, dell' IP e dell'intervallo di porte
bersaglio = input("Digita l'IP che desideri scansionare: ")
intervallo_porte = input("Digita l'intervallo di porte che desideri scansionare da 0 a 65535 (esempio: 100-350): ")

porta_iniziale = int(intervallo_porte.split("-")[0])
porta_finale = int(intervallo_porte.split("-")[1])

#Liste per porte aperte e chiuse
porte_aperte = []
porte_chiuse = []

#Scansione delle porte nell'intervallo specificato
for porta in range(porta_iniziale, porta_finale + 1):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    stato_porta = s.connect_ex((bersaglio, porta))
    if stato_porta == 0:
        porte_aperte.append(porta)
    else:
        porte_chiuse.append(porta)
    s.close()

#Scelta della lista da visualizzare
scelta_lista = input("Vuoi vedere le porte aperte o chiuse? (A/C): ").upper()

#Visualizzazione della lista scelta dall'utente
if scelta_lista == "A":
    print(f"Porte trovate aperte: {porte_aperte}")
elif scelta_lista == "C":
    print(f"Porte trovate chiuse: {porte_chiuse}")
else:
    print("Scelta non valida. Grazie per aver scelto NETREBELS.")